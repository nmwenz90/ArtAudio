{"ast":null,"code":"import _classCallCheck from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _get from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { TicksClass } from \"../type/Ticks\";\nimport { TransportEvent } from \"./TransportEvent\";\n/**\n * TransportRepeatEvent is an internal class used by Tone.Transport\n * to schedule repeat events. This class should not be instantiated directly.\n */\n\nexport var TransportRepeatEvent = /*#__PURE__*/function (_TransportEvent) {\n  _inherits(TransportRepeatEvent, _TransportEvent);\n\n  var _super = _createSuper(TransportRepeatEvent);\n\n  /**\n   * @param transport The transport object which the event belongs to\n   */\n  function TransportRepeatEvent(transport, opts) {\n    var _this;\n\n    _classCallCheck(this, TransportRepeatEvent);\n\n    _this = _super.call(this, transport, opts);\n    /**\n     * The ID of the current timeline event\n     */\n\n    _this._currentId = -1;\n    /**\n     * The ID of the next timeline event\n     */\n\n    _this._nextId = -1;\n    /**\n     * The time of the next event\n     */\n\n    _this._nextTick = _this.time;\n    /**\n     * a reference to the bound start method\n     */\n\n    _this._boundRestart = _this._restart.bind(_assertThisInitialized(_this));\n    var options = Object.assign(TransportRepeatEvent.getDefaults(), opts);\n    _this.duration = new TicksClass(transport.context, options.duration).valueOf();\n    _this._interval = new TicksClass(transport.context, options.interval).valueOf();\n    _this._nextTick = options.time;\n\n    _this.transport.on(\"start\", _this._boundRestart);\n\n    _this.transport.on(\"loopStart\", _this._boundRestart);\n\n    _this.context = _this.transport.context;\n\n    _this._restart();\n\n    return _this;\n  }\n\n  _createClass(TransportRepeatEvent, [{\n    key: \"invoke\",\n    value:\n    /**\n     * Invoke the callback. Returns the tick time which\n     * the next event should be scheduled at.\n     * @param  time  The AudioContext time in seconds of the event\n     */\n    function invoke(time) {\n      // create more events if necessary\n      this._createEvents(time); // call the super class\n\n\n      _get(_getPrototypeOf(TransportRepeatEvent.prototype), \"invoke\", this).call(this, time);\n    }\n    /**\n     * Push more events onto the timeline to keep up with the position of the timeline\n     */\n\n  }, {\n    key: \"_createEvents\",\n    value: function _createEvents(time) {\n      // schedule the next event\n      var ticks = this.transport.getTicksAtTime(time);\n\n      if (ticks >= this.time && ticks >= this._nextTick && this._nextTick + this._interval < this.time + this.duration) {\n        this._nextTick += this._interval;\n        this._currentId = this._nextId;\n        this._nextId = this.transport.scheduleOnce(this.invoke.bind(this), new TicksClass(this.context, this._nextTick).toSeconds());\n      }\n    }\n    /**\n     * Push more events onto the timeline to keep up with the position of the timeline\n     */\n\n  }, {\n    key: \"_restart\",\n    value: function _restart(time) {\n      this.transport.clear(this._currentId);\n      this.transport.clear(this._nextId);\n      this._nextTick = this.time;\n      var ticks = this.transport.getTicksAtTime(time);\n\n      if (ticks > this.time) {\n        this._nextTick = this.time + Math.ceil((ticks - this.time) / this._interval) * this._interval;\n      }\n\n      this._currentId = this.transport.scheduleOnce(this.invoke.bind(this), new TicksClass(this.context, this._nextTick).toSeconds());\n      this._nextTick += this._interval;\n      this._nextId = this.transport.scheduleOnce(this.invoke.bind(this), new TicksClass(this.context, this._nextTick).toSeconds());\n    }\n    /**\n     * Clean up\n     */\n\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(TransportRepeatEvent.prototype), \"dispose\", this).call(this);\n\n      this.transport.clear(this._currentId);\n      this.transport.clear(this._nextId);\n      this.transport.off(\"start\", this._boundRestart);\n      this.transport.off(\"loopStart\", this._boundRestart);\n      return this;\n    }\n  }], [{\n    key: \"getDefaults\",\n    value: function getDefaults() {\n      return Object.assign({}, TransportEvent.getDefaults(), {\n        duration: Infinity,\n        interval: 1,\n        once: false\n      });\n    }\n  }]);\n\n  return TransportRepeatEvent;\n}(TransportEvent);","map":{"version":3,"mappings":"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","names":["TicksClass","TransportEvent","TransportRepeatEvent","transport","opts","time","_restart","bind","options","Object","assign","getDefaults","duration","context","valueOf","_interval","interval","_nextTick","on","_boundRestart","_createEvents","ticks","getTicksAtTime","_currentId","_nextId","scheduleOnce","invoke","toSeconds","clear","Math","ceil","off","Infinity","once"],"sourceRoot":"","sources":["../../../../Tone/core/clock/TransportRepeatEvent.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}