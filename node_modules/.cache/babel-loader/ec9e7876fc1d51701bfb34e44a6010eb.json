{"ast":null,"code":"import _classCallCheck from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _get from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/natewamwenze/Documents/personalProjects/musicidea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { Signal } from \"./Signal\";\nimport { optionsFromArguments } from \"../core/util/Defaults\";\nimport { TransportTimeClass } from \"../core/type/TransportTime\";\nimport { ToneConstantSource } from \"./ToneConstantSource\";\n/**\n * Adds the ability to synchronize the signal to the [[Transport]]\n */\n\nexport var SyncedSignal = /*#__PURE__*/function (_Signal) {\n  _inherits(SyncedSignal, _Signal);\n\n  var _super = _createSuper(SyncedSignal);\n\n  function SyncedSignal() {\n    var _this;\n\n    _classCallCheck(this, SyncedSignal);\n\n    _this = _super.call(this, optionsFromArguments(Signal.getDefaults(), arguments, [\"value\", \"units\"]));\n    _this.name = \"SyncedSignal\";\n    /**\n     * Don't override when something is connected to the input\n     */\n\n    _this.override = false;\n    var options = optionsFromArguments(Signal.getDefaults(), arguments, [\"value\", \"units\"]);\n    _this._lastVal = options.value;\n    _this._synced = _this.context.transport.scheduleRepeat(_this._onTick.bind(_assertThisInitialized(_this)), \"1i\");\n    _this._syncedCallback = _this._anchorValue.bind(_assertThisInitialized(_this));\n\n    _this.context.transport.on(\"start\", _this._syncedCallback);\n\n    _this.context.transport.on(\"pause\", _this._syncedCallback);\n\n    _this.context.transport.on(\"stop\", _this._syncedCallback); // disconnect the constant source from the output and replace it with another one\n\n\n    _this._constantSource.disconnect();\n\n    _this._constantSource.stop(0); // create a new one\n\n\n    _this._constantSource = _this.output = new ToneConstantSource({\n      context: _this.context,\n      offset: options.value,\n      units: options.units\n    }).start(0);\n\n    _this.setValueAtTime(options.value, 0);\n\n    return _this;\n  }\n  /**\n   * Callback which is invoked every tick.\n   */\n\n\n  _createClass(SyncedSignal, [{\n    key: \"_onTick\",\n    value: function _onTick(time) {\n      var val = _get(_getPrototypeOf(SyncedSignal.prototype), \"getValueAtTime\", this).call(this, this.context.transport.seconds); // approximate ramp curves with linear ramps\n\n\n      if (this._lastVal !== val) {\n        this._lastVal = val;\n\n        this._constantSource.offset.setValueAtTime(val, time);\n      }\n    }\n    /**\n     * Anchor the value at the start and stop of the Transport\n     */\n\n  }, {\n    key: \"_anchorValue\",\n    value: function _anchorValue(time) {\n      var val = _get(_getPrototypeOf(SyncedSignal.prototype), \"getValueAtTime\", this).call(this, this.context.transport.seconds);\n\n      this._lastVal = val;\n\n      this._constantSource.offset.cancelAndHoldAtTime(time);\n\n      this._constantSource.offset.setValueAtTime(val, time);\n    }\n  }, {\n    key: \"getValueAtTime\",\n    value: function getValueAtTime(time) {\n      var computedTime = new TransportTimeClass(this.context, time).toSeconds();\n      return _get(_getPrototypeOf(SyncedSignal.prototype), \"getValueAtTime\", this).call(this, computedTime);\n    }\n  }, {\n    key: \"setValueAtTime\",\n    value: function setValueAtTime(value, time) {\n      var computedTime = new TransportTimeClass(this.context, time).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"setValueAtTime\", this).call(this, value, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"linearRampToValueAtTime\",\n    value: function linearRampToValueAtTime(value, time) {\n      var computedTime = new TransportTimeClass(this.context, time).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"linearRampToValueAtTime\", this).call(this, value, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"exponentialRampToValueAtTime\",\n    value: function exponentialRampToValueAtTime(value, time) {\n      var computedTime = new TransportTimeClass(this.context, time).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"exponentialRampToValueAtTime\", this).call(this, value, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"setTargetAtTime\",\n    value: function setTargetAtTime(value, startTime, timeConstant) {\n      var computedTime = new TransportTimeClass(this.context, startTime).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"setTargetAtTime\", this).call(this, value, computedTime, timeConstant);\n\n      return this;\n    }\n  }, {\n    key: \"cancelScheduledValues\",\n    value: function cancelScheduledValues(startTime) {\n      var computedTime = new TransportTimeClass(this.context, startTime).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"cancelScheduledValues\", this).call(this, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"setValueCurveAtTime\",\n    value: function setValueCurveAtTime(values, startTime, duration, scaling) {\n      var computedTime = new TransportTimeClass(this.context, startTime).toSeconds();\n      duration = this.toSeconds(duration);\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"setValueCurveAtTime\", this).call(this, values, computedTime, duration, scaling);\n\n      return this;\n    }\n  }, {\n    key: \"cancelAndHoldAtTime\",\n    value: function cancelAndHoldAtTime(time) {\n      var computedTime = new TransportTimeClass(this.context, time).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"cancelAndHoldAtTime\", this).call(this, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"setRampPoint\",\n    value: function setRampPoint(time) {\n      var computedTime = new TransportTimeClass(this.context, time).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"setRampPoint\", this).call(this, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"exponentialRampTo\",\n    value: function exponentialRampTo(value, rampTime, startTime) {\n      var computedTime = new TransportTimeClass(this.context, startTime).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"exponentialRampTo\", this).call(this, value, rampTime, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"linearRampTo\",\n    value: function linearRampTo(value, rampTime, startTime) {\n      var computedTime = new TransportTimeClass(this.context, startTime).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"linearRampTo\", this).call(this, value, rampTime, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"targetRampTo\",\n    value: function targetRampTo(value, rampTime, startTime) {\n      var computedTime = new TransportTimeClass(this.context, startTime).toSeconds();\n\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"targetRampTo\", this).call(this, value, rampTime, computedTime);\n\n      return this;\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(SyncedSignal.prototype), \"dispose\", this).call(this);\n\n      this.context.transport.clear(this._synced);\n      this.context.transport.off(\"start\", this._syncedCallback);\n      this.context.transport.off(\"pause\", this._syncedCallback);\n      this.context.transport.off(\"stop\", this._syncedCallback);\n\n      this._constantSource.dispose();\n\n      return this;\n    }\n  }]);\n\n  return SyncedSignal;\n}(Signal);","map":{"version":3,"mappings":"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","names":["Signal","optionsFromArguments","TransportTimeClass","ToneConstantSource","SyncedSignal","getDefaults","arguments","options","_lastVal","value","_synced","context","transport","scheduleRepeat","_onTick","bind","_syncedCallback","_anchorValue","on","_constantSource","disconnect","stop","output","offset","units","start","setValueAtTime","time","val","seconds","cancelAndHoldAtTime","computedTime","toSeconds","startTime","timeConstant","values","duration","scaling","rampTime","clear","off","dispose"],"sourceRoot":"","sources":["../../../Tone/signal/SyncedSignal.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}